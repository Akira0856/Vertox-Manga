<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VERTOX MANGA - Manga Details</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a1a1a;
            --secondary-color: #2d2d2d;
            --accent-color: #ff4081;
            --text-color: #ffffff;
            --card-bg: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--primary-color);
            color: var(--text-color);
        }

        /* Header */
        .header {
            background-color: var(--secondary-color);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-button {
            color: var(--text-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .language-selector {
            display: flex;
            gap: 1rem;
        }

        .language-button {
            padding: 0.5rem 1rem;
            background-color: var(--accent-color);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            text-decoration: none;
        }

        /* Manga Details */
        .manga-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .manga-cover {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .manga-title {
            font-size: 2em;
            margin-bottom: 1rem;
        }

        .manga-info {
            margin-bottom: 2rem;
        }

        .favorite-button {
            background: none;
            border: none;
            color: var(--accent-color);
            font-size: 2em;
            cursor: pointer;
            margin: 1rem 0;
        }

        /* Navigation Tabs */
        .tabs {
            display: flex;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--secondary-color);
        }

        .tab {
            padding: 1rem 2rem;
            cursor: pointer;
            color: var(--text-color);
            background: none;
            border: none;
            font-size: 1.1em;
        }

        .tab.active {
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            margin-bottom: -2px;
        }

        /* Comments Section */
        .comments-section {
            margin-top: 2rem;
        }

        .comment-form {
            margin-bottom: 2rem;
        }

        .comment-input {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: var(--card-bg);
            border: none;
            border-radius: 4px;
            color: var(--text-color);
        }

        .comment-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .comment {
            background-color: var(--card-bg);
            padding: 1rem;
            border-radius: 4px;
        }

        .comment-username {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        /* Chapters Section */
        .chapters-section {
            display: none;
        }

        .chapter-list {
            display: grid;
            gap: 0.5rem;
        }

        .chapter-item {
            background-color: var(--card-bg);
            padding: 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .chapter-item:hover {
            background-color: var(--secondary-color);
        }

        /* Chapter Reader */
        .chapter-reader {
            display: none;
            padding: 2rem 0;
        }

        .chapter-images {
            display: flex;
            flex-direction: column;
            
            margin-bottom: 2rem;
        }

        .chapter-image {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            display: block;
        }

        .chapter-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--secondary-color);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            z-index: 100;
        }

        .chapter-nav-button {
            padding: 0.5rem 1rem;
            background-color: var(--accent-color);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header class="header">
        <a href="index.html" class="back-button">
            <span class="material-icons">arrow_back</span>
            Back to Home
        </a>
        <div class="language-selector">
            <a href="english.html" class="language-button">English</a>
            <a href="malayalam.html" class="language-button">Malayalam</a>
        </div>
    </header>

    <main class="manga-container">
        <img src="https://ia903402.us.archive.org/BookReader/BookReaderImages.php?zip=/6/items/omniscient-reader-vol.-1/Omniscient-Reader%20Vol.1_jp2.zip&file=Omniscient-Reader%20Vol.1_jp2/Omniscient-Reader%20Vol.1_0000.jp2&id=omniscient-reader-vol.-1&scale=4&rotate=0" alt="Manga Cover" class="manga-cover">
        <button class="favorite-button" id="favoriteBtn">
            <span class="material-icons">favorite_border</span>
        </button>
        <h1 class="manga-title">Omniscient Reader's Viewpoint</h1>
        <div class="manga-info">
            <p><strong>Author:</strong> Sing Shong</p>
            <p><strong>Status:</strong> Ongoing</p>
            <p><strong>Genres:</strong> Action, Adventure, Fantasy, Psychological, Drama</p>
            <p><strong>Description:</strong> Kim Dokja, an ordinary reader of a popular web novel, finds himself in a world where the novel he loved becomes reality. Armed with his unparalleled knowledge of the plot, he must navigate life-threatening scenarios to survive and save humanity.</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="comments">Comments</button>
            <button class="tab" data-tab="chapters">Chapters</button>
        </div>

        <div class="comments-section" id="commentsSection">
            <div class="comment-form">
                <textarea class="comment-input" placeholder="Write a comment..." rows="4"></textarea>
                <button class="chapter-nav-button" id="commentBtn">Send Comment</button>
            </div>
            <div class="comment-list" id="commentList">
                <!-- Comments will be loaded here -->
            </div>
        </div>

        <div class="chapters-section" id="chaptersSection">
            <div class="chapter-list" id="chapterList">
                <!-- Chapters will be loaded dynamically -->
            </div>
        </div>

        <div class="chapter-reader" id="chapterReader">
            <div class="chapter-images" id="chapterImages">
                <!-- Chapter images will be loaded dynamically -->
            </div>
            <div class="chapter-navigation">
                <button class="chapter-nav-button" id="prevChapterBtn">Previous Chapter</button>
                <button class="chapter-nav-button" id="goToChaptersBtn">Go to Chapters</button>
                <button class="chapter-nav-button" id="nextChapterBtn">Next Chapter</button>
            </div>
        </div>
    </main>

    <script type="module">
        // Import Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA8J2CpnOfNUlGRiCgwWjcYrp6Fz9UraBw",
            authDomain: "vertox-94ce3.firebaseapp.com",
            projectId: "vertox-94ce3",
            storageBucket: "vertox-94ce3.firebasestorage.app",
            messagingSenderId: "1090403125068",
            appId: "1:1090403125068:web:5a813501021c081aea71e9",
            measurementId: "G-4MYR2F696Q"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // DOM Elements
        const tabs = document.querySelectorAll('.tab');
        const commentsSection = document.getElementById('commentsSection');
        const chaptersSection = document.getElementById('chaptersSection');
        const chapterReader = document.getElementById('chapterReader');
        const commentBtn = document.getElementById('commentBtn');
        const commentInput = document.querySelector('.comment-input');
        const commentList = document.getElementById('commentList');
        const chapterList = document.getElementById('chapterList');
        const chapterImages = document.getElementById('chapterImages');
        const prevChapterBtn = document.getElementById('prevChapterBtn');
        const goToChaptersBtn = document.getElementById('goToChaptersBtn');
        const nextChapterBtn = document.getElementById('nextChapterBtn');
        const favoriteBtn = document.getElementById('favoriteBtn');

        // Username handling
        let username = localStorage.getItem('username');
        if (!username) {
            username = prompt('Please enter your username:');
            localStorage.setItem('username', username);
        }

        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                if (tabName === 'comments') {
                    commentsSection.style.display = 'block';
                    chaptersSection.style.display = 'none';
                    chapterReader.style.display = 'none';
                } else {
                    commentsSection.style.display = 'none';
                    chaptersSection.style.display = 'block';
                    chapterReader.style.display = 'none';
                }
            });
        });

        // Comments functionality
        async function loadComments() {
            try {
                const commentsRef = collection(db, 'comments');
                const q = query(commentsRef, orderBy('timestamp', 'desc'));
                const querySnapshot = await getDocs(q);
                
                commentList.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const comment = doc.data();
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment';
                    commentElement.innerHTML = `
                        <div class="comment-username">${comment.username}</div>
                        <div class="comment-text">${comment.text}</div>
                    `;
                    commentList.appendChild(commentElement);
                });
            } catch (error) {
                console.error('Error loading comments:', error);
            }
        }

        commentBtn.addEventListener('click', async () => {
            const text = commentInput.value.trim();
            if (text) {
                try {
                    await addDoc(collection(db, 'comments'), {
                        username,
                        text,
                        timestamp: new Date()
                    });
                    commentInput.value = '';
                    loadComments();
                } catch (error) {
                    console.error('Error adding comment:', error);
                }
            }
        });

        // Chapter data structure
        const chapters = [
            {
                number: 1,
                title: "The Beginning",
                images: [
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338889071736524850/Untitled3_20250210205347.jpg?ex=67acb91e&is=67ab679e&hm=fe9e752f66397f3133755b9025d0f7e43dd074a9f747ea0adac5ef51ffce9b80&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892679148343396/Untitled4_20250211185602.jpg?ex=67acbc7a&is=67ab6afa&hm=ff56699c2375690dc027601ef7d3e0c2c94cd5bde44bf0e59f9575518299df15&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892680146714766/Untitled5_20250211191027.jpg?ex=67acbc7a&is=67ab6afa&hm=f416c718336d061c800131e0b2ac4ee7af7cb3ccbed725816c73cc3b449adfe9&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892680146714766/Untitled5_20250211191027.jpg?ex=67acbc7a&is=67ab6afa&hm=f416c718336d061c800131e0b2ac4ee7af7cb3ccbed725816c73cc3b449adfe9&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892681018998845/Untitled7_20250211191454.jpg?ex=67acbc7a&is=67ab6afa&hm=7cb1e9000dd1b9a795c2e8a560c90094609177234c7556912f492521ab288858&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892681799008307/Untitled8_20250211192107.jpg?ex=67acbc7a&is=67ab6afa&hm=520631a5237d59f54fe425ed277734a163bc9b828ca97d40a8dca64d3f7d6684&",
                    "https://cdn.discordapp.com/attachments/1338888782719750240/1338892682482810932/Untitled9_20250211192548.jpg?ex=67acbc7a&is=67ab6afa&hm=4bb8919a1731675a77d65ac4d84e16279aeace03d420b6fb6395fc8a2cc59369&",
                    
                ]
            },
            
        ];

        let currentChapter = 0;

        // Modified chapter loading function
        function loadChapters() {
            chapterList.innerHTML = '';
            chapters.forEach(chapter => {
                const chapterElement = document.createElement('div');
                chapterElement.className = 'chapter-item';
                chapterElement.textContent = `Chapter ${String(chapter.number).padStart(3, '0')} - ${chapter.title}`;
                chapterElement.addEventListener('click', () => loadChapter(chapter.number - 1));
                chapterList.appendChild(chapterElement);
            });
        }

        function loadChapter(chapterIndex) {
            if (chapterIndex < 0 || chapterIndex >= chapters.length) return;
            
            currentChapter = chapterIndex;
            chaptersSection.style.display = 'none';
            chapterReader.style.display = 'block';
            
            const chapter = chapters[chapterIndex];
            chapterImages.innerHTML = '';
            
            chapter.images.forEach((imageUrl, index) => {
                const img = document.createElement('img');
                img.className = 'chapter-image';
                img.src = imageUrl;
                img.alt = `Chapter ${chapter.number} - Page ${index + 1}`;
                chapterImages.appendChild(img);
            });

            // Update navigation buttons
            prevChapterBtn.disabled = currentChapter === 0;
            nextChapterBtn.disabled = currentChapter === chapters.length - 1;
        }

        // Navigation button handlers
        prevChapterBtn.addEventListener('click', () => {
            if (currentChapter > 0) {
                loadChapter(currentChapter - 1);
            }
        });

        nextChapterBtn.addEventListener('click', () => {
            if (currentChapter < chapters.length - 1) {
                loadChapter(currentChapter + 1);
            }
        });

        goToChaptersBtn.addEventListener('click', () => {
            chapterReader.style.display = 'none';
            chaptersSection.style.display = 'block';
        });

        // Favorites functionality
        let isFavorite = localStorage.getItem('favorite_manga_title') === 'true';
        updateFavoriteButton();

        favoriteBtn.addEventListener('click', () => {
            isFavorite = !isFavorite;
            localStorage.setItem('favorite_manga_title', isFavorite);
            updateFavoriteButton();
        });

        function updateFavoriteButton() {
            favoriteBtn.innerHTML = `
                <span class="material-icons">${isFavorite ? 'favorite' : 'favorite_border'}</span>
            `;
        }

        // Initial load
        loadComments();
        loadChapters();
    </script>
</body>
</html>